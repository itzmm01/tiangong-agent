{"id": 1463304049502715904, "name": "MySQL_8.0.27_0", "jobs": [{"job": {"host": "local", "name": "prepare env", "tasks": [{"cmd": "rm -rf ${WORKSPACE_DIR}/${MATERIAL_NAME} && rm -rf /tmp/recovery_log", "name": ".1.clear material", "type": "command", "title": "清理物料包"}, {"cmd": "init-umount-disk.sh  ${INSTALL_DISK_DEV_NAME}", "name": ".2.unmount install disk", "type": "script", "title": "卸载安装磁盘", "allow_failed": true, "local_script": "./tools/init/init-umount-disk.sh", "item_condition": "${INSTALL_DISK_DEV_NAME}"}, {"cmd": "init-clear-disk.sh ${INSTALL_DISK_DEV_NAME}", "name": ".3.clear install disk", "type": "script", "title": "清理安装磁盘", "allow_failed": false, "local_script": "./tools/init/init-clear-disk.sh", "item_condition": "${INSTALL_DISK_DEV_NAME}"}, {"cmd": "init-mount-disk.sh xfs ${INSTALL_DISK_DEV_NAME} ${WORKSPACE_DIR} 'defaults,noatime,nodiratime,prjquota 0 2' '-n ftype=1'", "name": ".4.mount install disk", "type": "script", "title": "挂载安装磁盘", "allow_failed": false, "local_script": "./tools/init/init-mount-disk.sh", "item_condition": "${INSTALL_DISK_DEV_NAME}"}], "title": "环境准备", "duration": 600}}, {"job": {"host": "local", "name": "1. prepare material", "tasks": [{"cmd": "mkdir -p ${WORKSPACE_DIR} && cd ${WORKSPACE_DIR} && wget --progress=bar:force '${MATERIAL_URL}' -O ${MATERIAL_NAME}", "name": "1.2.download material", "type": "command", "title": "下载物料包", "time_out": 600}, {"cmd": "cd ${WORKSPACE_DIR} && unzip -o  ${MATERIAL_NAME} -d ${MATERIAL_FOLDER}", "name": "1.2. unzip material", "type": "command", "title": "解压物料包(zip)", "item_condition": "${MATERIAL_IS_ZIP}"}, {"cmd": "cd ${WORKSPACE_DIR} && tar zxvf ${MATERIAL_NAME}", "name": "1.2.1 unzip material", "type": "command", "title": "解压物料包(tar)", "time_out": 600, "item_condition": "not ${MATERIAL_IS_ZIP}"}, {"cmd": "cd ${INSTALL_DIR}/conf && wget --progress=bar:force '${CONFIG_URL}' -O conf.zip", "name": "1.3. download config", "type": "command", "title": "下载配置文件"}, {"cmd": "cd ${INSTALL_DIR}/conf && unzip -o conf.zip -d .", "name": "1.4. unzip conf zip", "type": "command", "title": "配置文件解压"}, {"cmd": "cd ${INSTALL_DIR}/material && wget --progress=bar:force '${PRODUCT_MATERIALS.url}' -O ${PRODUCT_MATERIALS.name}", "name": "1.6. download product material", "type": "command", "title": "下载产品物料", "time_out": 36000, "with_items": "PRODUCT_MATERIALS"}, {"cmd": "wget --progress=bar:force '${SETUP_TOOLS_URL}' -O  ${WORKSPACE_DIR}/setup-tools.tar.gz", "name": "1.6. download setup-tools", "type": "command", "title": "下载setup-tools", "time_out": 600}, {"cmd": "cd ${WORKSPACE_DIR} && tar -zxvf setup-tools.tar.gz -C ./ && rm -rf ${INSTALL_DIR}/tools/* && mv setup-tools/* ${INSTALL_DIR}/tools", "name": "1.7. unzip setup-tools.tar.gz", "type": "command", "title": "解压setup-tools", "time_out": 600}], "title": "物料准备", "duration": 600}}, {"job": {"host": "local", "name": "2. install", "tasks": [{"cmd": "cd ${INSTALL_DIR} && sh bin/pre-init-check.sh", "name": "2.1 pre init check", "type": "command", "title": "初始化检查", "time_out": 3600}, {"cmd": "cd ${INSTALL_DIR} && sh bin/init.sh", "name": "2.2. init", "type": "command", "title": "初始化", "time_out": 3600}, {"cmd": "cd ${INSTALL_DIR} && sh bin/pre-install-check.sh", "name": "2.3. pre install check", "type": "command", "title": "安装检查", "time_out": 3600}, {"cmd": "cd ${INSTALL_DIR} && sh bin/install.sh", "name": "2.4 install", "type": "command", "title": "安装", "time_out": 36000}], "title": "安装", "duration": 1800}}], "host": {"ALL_HOST": [{"ip": "10.10.0.1", "port": 22, "user": "root", "password": "Iloveqianhui1314@"}], "client": [{"ip": "10.10.0.1", "port": 22, "user": "root", "password": "Iloveqianhui1314@"}], "mysqld": [{"ip": "10.10.0.1", "port": 22, "user": "root", "password": "Iloveqianhui1314@"}]}, "params": {"WORKSPACE_DIR": "/home", "PRODUCT_MATERIALS": [], "CONFIG_URL": "https://material-1252749592.cos.ap-guangzhou.myqcloud.com/product/5b8704360975409a8cb7c6b3c7f27005/plan/conf_20220402135454.zip?q-sign-algorithm=sha1&q-ak=AKIDaz60dz5uSkmY3HEuJRIrACxSheKjriIa&q-sign-time=1649221090;1649264290&q-key-time=1649221090;1649264290&q-header-list=host&q-url-param-list=&q-signature=b55556e520c712881efb110549ffdae0b2b736c5", "INSTALL_DIR": "/home/MySQL-one-deploy", "MATERIAL_URL": "https://www.tonyandmoney.cn/designer//git/v1/downloadRepo?productId=1436166083269623808&sha=master", "MATERIAL_NAME": "MySQL-one-deploy-8.0.27.zip", "MATERIAL_FOLDER": "MySQL-one-deploy", "MATERIAL_IS_ZIP": true, "SETUP_TOOLS_URL": "https://material-1252749592.cos.ap-guangzhou.myqcloud.com/commons/setup-tools-1221.tar.gz?q-sign-algorithm=sha1&q-ak=AKIDaz60dz5uSkmY3HEuJRIrACxSheKjriIa&q-sign-time=1648878899;1648922099&q-key-time=1648878899;1648922099&q-header-list=host&q-url-param-list=&q-signature=595aaf96542cb8b8f8ac4ae80a36baddd4ce5cc4"}}